<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainstorm - Step 5: Interfere | Project Arrowhead</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-lightbulb"></i>
            </div>
            <h3>Loading Brainstorm Module</h3>
            <p>Preparing your ideation workspace...</p>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>

    <!-- Offline Banner -->
    <div id="offlineBanner" class="offline-banner">
        <div class="container">
            <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <i class="fas fa-wifi-slash me-2"></i>
                    <span>You're offline. Don't worry - your work is saved locally and will sync when you reconnect.</span>
                </div>
                <button class="btn btn-sm btn-outline-light" onclick="checkConnection()">
                    <i class="fas fa-sync me-1"></i>Try Again
                </button>
            </div>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay"></div>

    <!-- Global Navigation Sidebar -->
    <div id="globalSidebar">
        <div class="sidebar-header">
            <h4><i class="fas fa-bullseye me-2"></i>Project Arrowhead</h4>
        </div>
        <div class="sidebar-nav">
            <div class="nav-section">
                <h6>Main Navigation</h6>
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i>Home
                </a>
            </div>
            <div class="nav-section">
                <h6>Brainstorm Module</h6>
                <a href="brainstorm_step1.html" class="nav-link">
                    <i class="fas fa-lightbulb"></i>Step 1: Imitate
                </a>
                <a href="brainstorm_step2.html" class="nav-link">
                    <i class="fas fa-lightbulb"></i>Step 2: Ideate
                </a>
                <a href="brainstorm_step3.html" class="nav-link">
                    <i class="fas fa-lightbulb"></i>Step 3: Ignore
                </a>
                <a href="brainstorm_step4.html" class="nav-link">
                    <i class="fas fa-lightbulb"></i>Step 4: Integrate
                </a>
                <a href="brainstorm_step5.html" class="nav-link">
                    <i class="fas fa-lightbulb"></i>Step 5: Interfere
                </a>
            </div>
            <div class="nav-section">
                <h6>Choose Module</h6>
                <a href="choose_step1.html" class="nav-link">
                    <i class="fas fa-crosshairs"></i>Step 1: Scenarios
                </a>
                <a href="choose_step2.html" class="nav-link">
                    <i class="fas fa-crosshairs"></i>Step 2: Compare
                </a>
                <a href="choose_step3.html" class="nav-link">
                    <i class="fas fa-crosshairs"></i>Step 3: Important Aspects
                </a>
                <a href="choose_step4.html" class="nav-link">
                    <i class="fas fa-crosshairs"></i>Step 4: Evaluate
                </a>
                <a href="choose_step5.html" class="nav-link">
                    <i class="fas fa-crosshairs"></i>Step 5: Support Decision
                </a>
            </div>
            <div class="nav-section">
                <h6>Objectives Module</h6>
                <a href="objectives_step1.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 1: Objective
                </a>
                <a href="objectives_step2.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 2: Delegation
                </a>
                <a href="objectives_step3.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 3: Business Services
                </a>
                <a href="objectives_step4.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 4: Skills
                </a>
                <a href="objectives_step5.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 5: Tools
                </a>
                <a href="objectives_step6.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 6: Contacts
                </a>
                <a href="objectives_step7.html" class="nav-link">
                    <i class="fas fa-target"></i>Step 7: Cooperation
                </a>
            </div>
            <div class="nav-section">
                <h6>Task Management</h6>
                <a href="TaskListPage.html" class="nav-link">
                    <i class="fas fa-tasks"></i>Task List
                </a>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <!-- Navigation Header -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <button id="sidebarToggleBtn"><i class="fas fa-bars"></i></button>
                <a class="navbar-brand" href="index.html">
                    <i class="fas fa-bullseye me-2"></i>Project Arrowhead
                </a>
                <div class="navbar-nav ms-auto">
                    <a class="nav-link" href="TaskListPage.html">
                        <i class="fas fa-tasks me-1"></i>Task List
                    </a>
                    <button class="btn btn-outline-light btn-sm" id="navHomeButton">
                        <i class="fas fa-home me-1"></i>Home
                    </button>
                </div>
            </div>
        </nav>

        <!-- Progress Bar (for step pages only) -->
        <div class="container mt-3" id="progressContainer">
            <div class="progress mb-4">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 100%;" aria-valuenow="100" aria-valuemax="100">
                    Step 5 of 5 - Complete
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card shadow-sm border-0">
                        <div class="card-header bg-warning text-dark">
                            <h4 class="mb-0">
                                <i class="fas fa-lightbulb me-2"></i>Brainstorm - Step 5: Interfere
                            </h4>
                        </div>
                        <div class="card-body p-4">
                            <div class="question-section mb-4">
                                <h5 class="text-primary mb-3">Question:</h5>
                                <p class="lead">First, play devil's advocate. How could our own plan fail? What are its critical flaws, hidden assumptions, or potential blockers? Next, focus on the competition. It's easier to pass cars going in slow motion. How could we actively slow our competitors down or create a strategic disadvantage for them?</p>
                            </div>

                            <form id="brainstormStep5Form">
                                <div class="mb-4">
                                    <label for="brainstormStep5Input" class="form-label">Your Response:</label>
                                    <textarea
                                        class="form-control"
                                        id="brainstormStep5Input"
                                        rows="8"
                                        placeholder="Our biggest flaw is...&#10;A key assumption that might be wrong is...&#10;This could be blocked by...&#10;To slow down Competitor X, we could...&#10;We could build a competitive moat by...&#10;A strategic move to create a disadvantage for them is..."
                                        required
                                    ></textarea>
                                    <div class="form-text">
                                        <i class="fas fa-info-circle me-1"></i>Identifying potential problems early helps you prepare for them
                                    </div>
                                </div>

                                <div class="d-flex justify-content-between">
                                    <button type="button" class="btn btn-outline-secondary" id="previousButton">
                                        <i class="fas fa-arrow-left me-1"></i>Previous
                                    </button>
                                    <button type="submit" class="btn btn-success">
                                        Complete Brainstorm <i class="fas fa-check ms-1"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Add Task Section -->
                    <div class="card mt-4 shadow-sm border-0">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-plus me-2"></i>Create Task from Your Ideas
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">Turn your brainstorming insights into actionable tasks. You have full control over what becomes a task.</p>
                            <div class="mb-3">
                                <label for="taskContentInput" class="form-label">Task Description</label>
                                <textarea class="form-control" id="taskContentInput" rows="3" placeholder="Enter a specific task based on your brainstorming (e.g., 'Research competitor pricing strategies')..."></textarea>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="taskPersonInput" class="form-label">Assigned To</label>
                                    <input type="text" class="form-control" id="taskPersonInput" placeholder="Who will do this task?" value="">
                                </div>
                                <div class="col-md-6 d-flex align-items-end">
                                    <button class="btn btn-success w-100" onclick="createTaskFromCurrentStep()">
                                        <i class="fas fa-plus me-1"></i>Add Task
                                    </button>
                                </div>
                            </div>
                            <div class="mt-3">
                                <small class="text-muted">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Your brainstorming answers are automatically saved. Only create tasks for specific actions you want to track.
                                </small>
                            </div>
                        </div>
                    </div>

                    <!-- Export Section -->
                    <div class="card mt-4 shadow-sm border-0">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0">
                                <i class="fas fa-download me-2"></i>Export Your Brainstorm Session
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">Save your brainstorming process for future reference or sharing with your team.</p>
                            <div class="d-flex gap-2 flex-wrap">
                                <button class="btn btn-outline-primary" onclick="copyBrainstormResults()">
                                    <i class="fas fa-copy me-1"></i>Copy as Markdown
                                </button>
                                <button class="btn btn-outline-success" onclick="downloadBrainstormResults()">
                                    <i class="fas fa-file-download me-1"></i>Download JSON
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Next Step -->
                    <div class="card mt-4 shadow-sm border-0">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-arrow-right me-2"></i>Next: Decision Making
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="mb-3">Great brainstorming! Now let's use the Choose module to make decisions based on your ideas.</p>
                            <button class="btn btn-primary" onclick="window.location.href='choose_step1.html'">
                                <i class="fas fa-crosshairs me-1"></i>Start Decision Making
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Home Confirmation Modal -->
    <div class="modal fade" id="homeConfirmationModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirm Navigation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to go home? Your progress will be saved, but you'll need to navigate back to continue where you left off.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="modalGoHomeButton">Go Home</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Main JS -->
    <script src="main.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();

            loadFormData('brainstorm', 'step5', 'brainstormStep5Input');

            document.getElementById('brainstormStep5Form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveFormData('brainstorm', 'step5', 'brainstormStep5Input');
                // Note: Automatic task creation removed - users now have explicit control
                alert('Brainstorm module completed! Your responses have been saved.');
                // Stay on this page to show next step options (matches Objectives behavior)
            });

            const previousButton = document.getElementById('previousButton');
            if (previousButton) {
                previousButton.addEventListener('click', function(event) {
                    event.preventDefault();
                    saveFormData('brainstorm', 'step5', 'brainstormStep5Input');
                    window.location.href = 'brainstorm_step4.html';
                });
            }
        });

        // Function to create task from current brainstorm step
        function createTaskFromCurrentStep() {
            const taskContent = document.getElementById('taskContentInput').value;
            const taskPerson = document.getElementById('taskPersonInput').value || 'You';
            
            if (createTaskFromJourneyStep('brainstorm', 'step5', taskContent, taskPerson)) {
                // Clear the form after successful task creation
                document.getElementById('taskContentInput').value = '';
                document.getElementById('taskPersonInput').value = 'You';
            }
        }
    </script>
</body>
</html>
